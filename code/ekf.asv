function X_estimated = ekf(Zeta, X, U, p, P_time_update, R) % Takes them as 3d vectors

    dzetadt = position(Zeta, X);
    dxdt = dynamics(X, U, p);
    Hk = dzetadt / dxdt; % this is Hk that we get from chain rule

    Kk = P_time_update * Hk' * 1/(Hk * P_time_update * Hk' + R);

    P_estimated = 

end